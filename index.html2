<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üéÅ Ma Liste de Cadeaux</title>

  <!-- Police et ic√¥nes -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <!-- Manifest pour PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#7b61ff">

  <style>
    /* ---------- GLOBAL ---------- */
    :root {
      --primary: #7b61ff;
      --secondary: #5a4bff;
      --accent: #ff6584;
      --background: #101014;
      --card: #18181f;
      --text: #eaeaea;
      --muted: #a0a0a0;
      --border: #2d2d38;
      --success: #4ade80;
      --warning: #facc15;
      --error: #ef4444;
    }
    * { box-sizing: border-box; transition: all 0.25s ease; }
    body {
      font-family: "Poppins", sans-serif;
      margin: 0;
      background: radial-gradient(circle at top left, #1a1a24, #0d0d12);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header { text-align: center; padding: 4rem 1rem 2rem; }
    header h1 {
      font-size: 3rem;
      margin: 0;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    header p { color: var(--muted); font-size: 1.1rem; }

    .container {
      background: var(--card);
      padding: 2rem;
      width: 95%;
      max-width: 800px;
      border-radius: 20px;
      box-shadow: 0 0 40px rgba(0,0,0,0.4);
      margin-bottom: 3rem;
    }

    .profile-selector { display:flex; flex-wrap:wrap; justify-content:center; gap:0.75rem; margin-bottom:2rem; }
    select, button {
      border:none; outline:none; border-radius:12px; padding:0.8rem 1.2rem; font-size:1rem; font-family:inherit; cursor:pointer;
    }
    select { background:#22222a; color:var(--text); border:1px solid var(--border); }
    .btn { background:var(--primary); color:white; font-weight:600; display:flex; align-items:center; gap:0.5rem; }
    .btn:hover { background:var(--secondary); transform:translateY(-2px); }
    .btn-danger { background:var(--error); }
    .btn-danger:hover { background:#d83434; }

    #gift-list { display:flex; flex-direction:column; gap:1rem; }
    .gift-item {
      display:flex; justify-content:space-between; align-items:center;
      padding:1rem 1.5rem; border-radius:15px; background:#20202a; border:1px solid var(--border);
      box-shadow:0 3px 8px rgba(0,0,0,0.4);
    }
    .gift-item:hover { transform:scale(1.02); border-color:var(--primary); box-shadow:0 0 12px rgba(123,97,255,0.3); }
    .gift-item span { font-size:1.1rem; flex-grow:1; color:var(--text); }
    .gift-actions { display:flex; gap:0.5rem; }
    .edit-button { background:var(--warning); color:#000; padding:0.6rem 1rem; border-radius:10px; border:none; }
    .edit-button:hover { filter: brightness(1.1); }
    .delete-button { background:var(--error); color:#fff; padding:0.6rem 1rem; border-radius:10px; border:none; }
    .delete-button:hover { background:#d83434; }

    .add-gift { display:flex; gap:1rem; margin-top:2rem; }
    .add-gift input { flex-grow:1; background:#22222a; border:1px solid var(--border); border-radius:12px; padding:1rem; color:var(--text); font-size:1rem; }
    .add-gift input:focus { border-color:var(--primary); box-shadow:0 0 10px rgba(123,97,255,0.4); }
    .add-gift button { background:var(--primary); color:white; font-weight:600; border:none; border-radius:12px; padding:1rem 1.5rem; cursor:pointer; }
    .add-gift button:hover { background:var(--secondary); transform:scale(1.05); }

    footer { text-align:center; padding:1.5rem; font-size:0.95rem; color:var(--muted); }
    footer a { color:var(--primary); text-decoration:none; }
    footer a:hover { text-decoration:underline; }

  </style>
</head>
<body>
  <header>
    <h1><i class="fas fa-gift"></i> Ma Liste de Cadeaux</h1>
    <p>Cr√©ez, modifiez et organisez vos id√©es de cadeaux facilement üéÑ</p>
  </header>

  <div class="container">
    <div class="profile-selector">
      <select id="profile-select" onchange="changeProfile()" aria-label="S√©lecteur de profil">
        <option value="">S√©lectionnez un profil</option>
      </select>
      <button class="btn" onclick="createProfile()"><i class="fas fa-user-plus"></i> Cr√©er</button>
      <button class="btn btn-danger" onclick="deleteProfile()"><i class="fas fa-user-times"></i> Supprimer</button>
    </div>

    <div id="gift-list"></div>

    <div class="add-gift">
      <input type="text" id="gift-input" placeholder="Ajouter un cadeau..." aria-label="Champ d'ajout de cadeau">
      <button onclick="addGift()"><i class="fas fa-plus"></i> Ajouter</button>
    </div>
  </div>

  <footer>
    <p>‚ú® Cr√©√© avec <i class="fas fa-heart"></i> par <a href="#">Votre Nom</a></p>
  </footer>

  <script>
    // ---------- Service Worker ----------
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js")
        .then(() => console.log("Service Worker enregistr√© !"))
        .catch(err => console.log("Erreur SW :", err));
    }

    // ---------- Gestion des profils et cadeaux ----------
    const giftList = document.getElementById('gift-list');
    const giftInput = document.getElementById('gift-input');
    const profileSelect = document.getElementById('profile-select');

    let profiles = JSON.parse(localStorage.getItem('profiles')) || {};
    let currentProfile = localStorage.getItem('currentProfile') || null;

    function saveProfiles() {
      localStorage.setItem('profiles', JSON.stringify(profiles));
    }

    function populateProfileSelector() {
      profileSelect.innerHTML = '<option value="">S√©lectionnez un profil</option>';
      Object.keys(profiles).forEach(profile => {
        const option = document.createElement('option');
        option.value = profile;
        option.textContent = profile;
        profileSelect.appendChild(option);
      });
      if (currentProfile && profiles[currentProfile]) profileSelect.value = currentProfile;
    }

    function changeProfile() {
      currentProfile = profileSelect.value;
      localStorage.setItem('currentProfile', currentProfile);
      displayGifts();
    }

    function createProfile() {
      const profileName = prompt('Entrez le nom du profil :');
      if (profileName && !profiles[profileName]) {
        profiles[profileName] = [];
        saveProfiles();
        populateProfileSelector();
        profileSelect.value = profileName;
        changeProfile();
      } else if (profiles[profileName]) alert('Ce profil existe d√©j√†.');
    }

    function deleteProfile() {
      const profileToDelete = profileSelect.value;
      if (profileToDelete && confirm(`Voulez-vous vraiment supprimer le profil "${profileToDelete}" ?`)) {
        delete profiles[profileToDelete];
        saveProfiles();
        populateProfileSelector();
        currentProfile = null;
        localStorage.removeItem('currentProfile');
        displayGifts();
      } else if (!profileToDelete) alert('Veuillez s√©lectionner un profil √† supprimer.');
    }

    function displayGifts() {
      giftList.innerHTML = '';
      if (!currentProfile || !profiles[currentProfile]) {
        giftList.innerHTML = '<p style="text-align:center; color:var(--muted); margin-top:2rem;">S√©lectionnez ou cr√©ez un profil pour commencer üéÖ</p>';
        return;
      }

      profiles[currentProfile].forEach((gift, index) => {
        const giftItem = document.createElement('div');
        giftItem.className = 'gift-item';

        const giftText = document.createElement('span');
        giftText.textContent = gift;

        const actions = document.createElement('div');
        actions.className = 'gift-actions';

        const editButton = document.createElement('button');
        editButton.className = 'edit-button';
        editButton.innerHTML = '<i class="fas fa-edit"></i>';
        editButton.onclick = () => editGift(index);

        const deleteButton = document.createElement('button');
        deleteButton.className = 'delete-button';
        deleteButton.innerHTML = '<i class="fas fa-trash"></i>';
        deleteButton.onclick = () => deleteGift(index);

        actions.appendChild(editButton);
        actions.appendChild(deleteButton);
        giftItem.appendChild(giftText);
        giftItem.appendChild(actions);
        giftList.appendChild(giftItem);
      });
    }

    function addGift() {
      const gift = giftInput.value.trim();
      if (gift && currentProfile) {
        if (!profiles[currentProfile].includes(gift)) {
          profiles[currentProfile].push(gift);
          giftInput.value = '';
          saveProfiles();
          displayGifts();
        } else alert('Ce cadeau est d√©j√† dans la liste üéÅ');
      }
    }

    function editGift(index) {
      if (currentProfile) {
        const newGift = prompt('Modifier le cadeau :', profiles[currentProfile][index]);
        if (newGift !== null) {
          profiles[currentProfile][index] = newGift.trim();
          saveProfiles();
          displayGifts();
        }
      }
    }

    function deleteGift(index) {
      if (currentProfile) {
        profiles[currentProfile].splice(index, 1);
        saveProfiles();
        displayGifts();
      }
    }

    giftInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') addGift(); });

    populateProfileSelector();
    displayGifts();
  </script>
</body>
</html>
